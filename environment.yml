name: image-stitcher
channels:
  - conda-forge
  - pytorch
  - nvidia
dependencies:
  - python=3.10
  # Pin scipy to be compatible with jax 0.4.23 and basicpy
  # scipy 1.12-1.14 works with jax 0.4.23 on Windows
  - scipy>=1.12,<1.15
  # Note: pandas is downgraded to 1.5.3 for hyperactive 4.5.0 compatibility
  # This may cause warnings from dask-image and xarray but should still work
  - pandas>=1.5.0,<2.0.0
  - aicsimageio
  - dask-image
  - numpy
  - ome-zarr
  - zarr
  - psutil
  - pydantic>=2.10.5
  - pydantic-core>=2.27.2
  - pydantic-settings>=2.7.1
  - napari-ome-zarr
  - napari[all]
  - pyqt
  # Core dependencies for image processing
  - tifffile
  - tqdm
  - networkx
  - scikit-image
  - matplotlib
  # Testing dependencies
  - pytest
  # Tensor backend dependencies (optional GPU acceleration)
  # Note: These are optional and the system will fall back to NumPy if not available
  - pytorch::pytorch
  - pytorch::torchvision
  - pytorch::pytorch-cuda=12.1  # For CUDA 12.x compatibility
  - pip:
    # Pin hyperactive to 4.5.0 for compatibility with basicpy 1.2.0
    # Note: hyperactive 4.x requires pandas<2.0.0, which conflicts with some packages
    # but is necessary for basicpy to work properly
    - hyperactive==4.5.0
    # Install jax with Windows-compatible versions
    # Note: jax 0.4.23 is compatible with scipy 1.12-1.14 and works on Windows
    - jax==0.4.23
    - jaxlib==0.4.23
    # Install basicpy after jax to prevent dependency conflicts
    - basicpy>=1.2.0
  # CuPy will be installed via pip in setup scripts for better compatibility
  # NOTE: basicpy is now installed via pip above with compatible jax versions.
  # This prevents the scipy 1.15â†’1.12 downgrade that causes memory allocation
  # failures on Windows systems with limited virtual memory.
